(()=>{"use strict";const e=()=>{let e;const t=[],i={vendor:void 0,id:void 0,src:void 0,thumbnail:void 0,title:void 0,apikey:void 0,initialized:!1,parameters:void 0,y:void 0,debounce:250,lazyload:!0,initinview:!1,onLoad:e=>{},onAppend:e=>{},onThumbnailLoad:e=>{}},n={regex:{youtube_nocookie:/(?:youtube-nocookie\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=)))([a-zA-Z0-9_-]{6,11})/,youtube:/(?:youtube\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=))|youtu\.be\/)([a-zA-Z0-9_-]{6,11})/,vimeo:/vimeo\.com\/(?:video\/)?([0-9]*)(?:\?|)/},condition:{youtube:e=>!(!e||11!=e[1].length)&&e[1],youtube_nocookie:e=>!(!e||11!=e[1].length)&&e[1],vimeo:e=>!!(e&&9===e[1].length||8===e[1].length)&&e[1]},src:{youtube:e=>`https://www.youtube.com/embed/${e.id}/?${e.parameters}`,youtube_nocookie:e=>`https://www.youtube-nocookie.com/embed/${e.id}/?${e.parameters}`,vimeo:e=>`https://player.vimeo.com/video/${e.id}/?${e.parameters}`},endpoints:{youtube:e=>`https://www.googleapis.com/youtube/v3/videos?id=${e.id}&key=${e.apikey}&fields=items(snippet(title,thumbnails))&part=snippet`,youtube_nocookie:e=>`https://www.googleapis.com/youtube/v3/videos?id=${e.id}&key=${e.apikey}&fields=items(snippet(title,thumbnails))&part=snippet`,vimeo:e=>`https://vimeo.com/api/oembed.json?url=https%3A//vimeo.com/${e.id}`},response:{youtube:{title:e=>e.items[0].snippet.title,thumbnail:e=>{let t=e.items[0].snippet.thumbnails;return(t.maxres||t.standard||t.high||t.medium||t.default).url}},youtube_nocookie:{title:e=>e.items[0].snippet.title,thumbnail:e=>{let t=e.items[0].snippet.thumbnails;return(t.maxres||t.standard||t.high||t.medium||t.default).url}},vimeo:{title:e=>e.title,thumbnail:e=>e.thumbnail_url}}};function o(t){if(t instanceof HTMLElement==0||t.classList.contains("lazyframe--loaded"))return;const i={el:t,settings:s(t)};i.el.addEventListener("click",(()=>{i.el.appendChild(i.iframe);const e=t.querySelectorAll("iframe");i.settings.onAppend.call(this,e[0])})),e.lazyload?u(i):a(i,i.settings.thumbnail)}function s(t){const i=Array.prototype.slice.apply(t.attributes).filter((e=>""!==e.value)).reduce(((e,t)=>(e[0===t.name.indexOf("data-")?t.name.split("data-")[1]:t.name]=t.value,e)),{}),o=Object.assign({},e,i,{y:t.offsetTop,parameters:l(i.src)});if(o.vendor){const e=o.src.match(n.regex[o.vendor]);o.id=n.condition[o.vendor](e)}return o}function l(e){let t=e.split("?");return t[1]?(t=t[1],-1!==t.indexOf("autoplay")?t:t+"&autoplay=1&rel=0"):"autoplay=1&rel=0"}function a(e){!function(e){return!(!e.vendor||e.title&&e.thumbnail||("youtube"===e.vendor||"youtube_nocookie"===e.vendor)&&!e.apikey)}(e.settings)?u(e,!0):function(e,t){const i=n.endpoints[e.settings.vendor](e.settings),o=new XMLHttpRequest;o.open("GET",i,!0),o.onload=function(){if(o.status>=200&&o.status<400){const i=JSON.parse(o.responseText);t(null,[i,e])}else t(!0)},o.onerror=function(){t(!0)},o.send()}(e,((t,i)=>{if(t)return;const o=i[0],s=i[1];if(s.settings.title||(s.settings.title=n.response[s.settings.vendor].title(o)),!s.settings.thumbnail){const t=n.response[s.settings.vendor].thumbnail(o);s.settings.thumbnail=t,e.settings.onThumbnailLoad.call(this,t)}u(s,!0)}))}function r(){const i=window.innerHeight;let n=t.length;const o=(e,t)=>{e.settings.initialized=!0,e.el.classList.add("lazyframe--loaded"),n--,a(e),e.settings.initinview&&e.el.click(),e.settings.onLoad.call(this,e)};t.filter((e=>e.settings.y<i)).forEach(o);const s=function(e,t,i){let n;return function(){let o=this,s=arguments,l=function(){n=null,e.apply(o,s)},a=i;clearTimeout(n),n=setTimeout(l,t),a&&e.apply(o,s)}}((()=>{r=l<window.pageYOffset,l=window.pageYOffset,r&&t.filter((e=>e.settings.y<i+l&&!1===e.settings.initialized)).forEach(o),0===n&&window.removeEventListener("scroll",s,!1)}),e.debounce);let l=0,r=!1;window.addEventListener("scroll",s,!1)}function u(i,o){if(i.iframe=function(e){const t=document.createDocumentFragment(),i=document.createElement("iframe");return e.vendor&&(e.src=n.src[e.vendor](e)),i.setAttribute("id",`lazyframe-${e.id}`),i.setAttribute("src",e.src),i.setAttribute("frameborder",0),i.setAttribute("allowfullscreen",""),t.appendChild(i),t}(i.settings),i.settings.thumbnail&&o&&(i.el.style.backgroundImage=`url(${i.settings.thumbnail})`),i.settings.title&&0===i.el.children.length){const e=document.createDocumentFragment(),t=document.createElement("span");t.className="lazyframe__title",t.innerHTML=i.settings.title,e.appendChild(t),i.el.appendChild(e)}e.lazyload||(i.el.classList.add("lazyframe--loaded"),i.settings.onLoad.call(this,i),t.push(i)),i.settings.initialized||t.push(i)}return function(t,...n){if(e=Object.assign({},i,n[0]),"string"==typeof t){const e=document.querySelectorAll(t);for(let t=0;t<e.length;t++)o(e[t])}else if(void 0===t.length)o(t);else if(t.length>1)for(let e=0;e<t.length;e++)o(t[e]);else o(t[0]);e.lazyload&&r()}};e(),window.lazyframe=e()})();